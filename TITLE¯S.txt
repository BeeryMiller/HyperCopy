*** TITLE/S ***
*
* title screen for HyperCopy
*
* mdd
*
       DEF  TITLE
       REF  MEMMAP
*
       DXOP SYS,0
*
SAVRET DATA >0000
MAPPER EQU  >F110
VDPA   EQU  >F10A
VDPD   EQU  >F108
HAB    BYTE >AB
HF4    BYTE >F4
KEY    DATA 5
*
TITLE  MOV  R11,@SAVRET
       LI   R1,MEMMAP
       INC  R1
       MOVB *R1+,@MAPPER+4    load pages to save vdp to
       MOVB *R1,@MAPPER+5
       LIMI 0
       CLR  R0
       MOVB R0,@VDPA
       SWPB R0                delay
       MOVB R0,@VDPA
       LI   R0,>8000
       LI   R1,>3FFF          so it doesn't wrap to next page <lazy me>
T01B   MOVB @VDPD,*R0+
       DEC  R1
       JNE  T01B
       LI   R0,>0060
       MOVB R0,@VDPA
       SWPB R0
       MOVB R0,@VDPA
       LI   R0,>1800          count
T01    MOVB @HF4,@VDPD
       DEC  R0
       JNE  T01
*
       LI   R0,>0078
       MOVB R0,@VDPA
       SWPB R0
       MOVB R0,@VDPA
       LI   R0,3
       CLR  R1
T01A   MOVB R1,@VDPD
       AI   R1,>0100
       JNC  T01A
       DEC  R0
       JNE  T01A
*
       LI   R0,>0040
       MOVB R0,@VDPA
       SWPB R0
       MOVB R0,@VDPA
*
       LI   R0,PICDAT         picture data
*
T02    MOVB *R0+,R1           get byte
       CB   R1,@HAB           repeat code?
       JNE  T06               no
       MOVB *R0+,R2           get repeat count
       MOVB *R0+,R1           get byte
       CB   R2,@HAB           that too?
       JNE  T04               no
       CB   R1,@HAB           that too?
       JNE  T04               no
* done with title screen
       LIMI 2
       LI   R0,5
T03    SYS  @KEY
       JNE  T03
       LIMI 0
       LI   R0,>40
       MOVB R0,@VDPA
       SWPB R0
       MOVB R0,@VDPA
       LI   R0,>8000
       LI   R1,>3FFF          so it doesn't wrap to next page <lazy me>
T03A   MOVB *R0+,@VDPD
       DEC  R1
       JNE  T03A
       LIMI 2
       MOV  @SAVRET,R11
       RT
*
*
T04    SRL  R2,8
       JNE  T05               not 0
       LI   R2,>100           really 256, then
T05    MOVB R1,@VDPD
       DEC  R2
       JNE  T05
       JMP  T02               keep going
*
T06    MOVB R1,@VDPD
       JMP  T02
*
*
* compressed picture data
* format: if byte is >AB, then next byte is repeat count followed by
*            byte to write
*         if not >AB, then write as is
*         if find sequence >ABABAB, marks end
PICDAT DATA 43776,171,5120,7968,24800,43780,225,8742
       DATA 11947,1024,65195,770,43780,15,4144,28843
       DATA 1024,61457,4887,43780,255,43779,427,1024
       DATA 1800,6200,43780,255,43783,255,43783,131
       DATA 33932,40107,1024,65451,1792,65451,1792,49474
       DATA 17998,43780,255,43783,255,43783,224,8483
       DATA 10155,1024,65451,1792,65451,1792,61456,4371
       DATA 43780,127,43779,32939,1024,65451,1792,63496
       DATA 2057,43780,63,16576,49323,1024,65451,1792
       DATA 64683,772,43780,31,8288,57515,1024,57634
       DATA 9774,43780,254,43779,683,6144,43784,427
       DATA 2272,43783,15872,43784,683,1776,63740,43783
       DATA 7936,43782,258,1195,2168,0,43781,3854
       DATA 0,43780,32768,427,1980,15360,171,1539
       DATA 0,65535,65276,63728,24158,40619,1310,0
       DATA 43781,939,768,43781,57344,43784,12203,2816
       DATA 43781,61611,1303,10087,51115,2176,43779,171
       DATA 1528,43784,2987,2240,0,43780,31864,28843
       DATA 1797,2475,1760,61688,43783,15872,43782,516
       DATA 2219,6144,43784,427,2272,43782,62,16043
       DATA 2050,65279,32575,7951,1799,0,43782,32776
       DATA 4267,1568,43784,30732,2219,1280,258,1032
       DATA 4128,16512,171,2108,939,1024,43779,1008
       DATA 43780,4336,57536,43784,7851,1024,683,771
       DATA 43780,7,897,49323,1071,53135,3983,43784
       DATA 243,65534,64767,43779,61575,43779,2039,43779
       DATA 6059,2176,43784,63659,2059,43784,49248,16384
       DATA 1,516,2065,8512,32939,1024,64766,65407
       DATA 16159,3855,43784,16,8363,1600,43800,171
       DATA 2049,43784,57515,2110,43784,683,2055,43784
       DATA 32939,2080,43784,30722,1195,1544,43784,171
       DATA 2108,43779,939,1280,32768,65451,1280,7710
       DATA 57003,1374,43784,939,2272,20395,1839,43784
       DATA 171,1008,43781,171,2071,43784,32939,1016
       DATA 43781,171,2059,43784,49168,8363,1600,43784
       DATA 171,2063,43784,171,2112,43800,171,1025
       DATA 43780,171,1023,65195,1024,65471,16191,43780
       DATA 252,63728,57515,1024,43780,1963,1024,43779
       DATA 65534,43780,192,32939,1536,43780,32683,1024
       DATA 61680,57536,43788,171,1087,43780,171,1279
       DATA 43780,255,65534,64683,1024,57259,799,43780
       DATA 255,64499,58283,1024,43779,65534,43780,207
       DATA 36623,4011,1024,43780,65451,1024,43780,65451
       DATA 1024,59335,34567,43780,171,1279,43780,171
       DATA 1279,43780,243,58307,33707,1024,43779,65534
       DATA 43780,128,32939,3584,43780,4011,1024,65535
       DATA 65276,43780,128,43827,31,4128,8363,1024
       DATA 7953,8738,43780,31,4386,16043,1024,8738
       DATA 17532,43780,62,8772,31915,1024,15880,4112
       DATA 43780,62,8256,23723,1024,8738,17532,43780
       DATA 248,8256,16555,1024,257,514,43780,63
       DATA 8514,32427,1024,7953,8766,43780,31,4386
       DATA 16043,3072,15394,17020,43780,68,17544,63659
       DATA 1536,257,43780,220,42024,18603,1024,31760
       DATA 8224,43780,68,17544,61611,1024,31808,33016
       DATA 43782,1,427,1024,61576,2313,43780,248
       DATA 34833,4523,1024,61576,2313,43780,240,34824
       DATA 2219,12288,8256,31915,1280,8772,31915,1280
       DATA 8256,16555,1280,4128,8363,1280,20616,34987
       DATA 1280,4128,63659,1280,17544,63659,1280,17544
       DATA 34987,1280,16512,32939,1280,516,1195,1280
       DATA 516,31915,1280,8772,31915,1280,8772,31915
       DATA 3328,17540,63659,1280,8256,16555,1280,258
       DATA 683,1280,2064,4523,1280,8257,61867,1280
       DATA 40977,4523,1280,32768,61611,1280,258,939
       DATA 1280,4370,58283,1280,4386,58283,1280,4370
       DATA 58283,1280,4112,57515,0,43776,171,0
       DATA 43776,171,15616,3587,43779,263,3901,43783
       DATA 128,43783,12,43815,48,43968,56,43782
       DATA 1,49216,16449,17996,55440,7220,50310,43780
       DATA 683,768,781,6192,24747,1280,43779,32939
       DATA 2816,257,774,1648,24768,32896,43823,1
       DATA 774,512,60,26306,257,43783,128,49323
       DATA 3584,1564,43888,3,518,3347,7224,12320
       DATA 16512,32939,1024,1540,1291,3100,6256,49280
       DATA 43780,1,960,16576,43779,32939,1024,32939
       DATA 1280,7195,7216,28796,61381,254,514,1564
       DATA 28864,43779,7,1451,772,43780,128,49216
       DATA 16555,6144,43779,770,1540,1032,0,49248
       DATA 14351,256,16448,8224,12152,57376,1,16096
       DATA 43780,112,32939,5632,1054,4643,43779,16769
       DATA 43788,24,7222,8875,18432,24640,43785,1
       DATA 774,1024,24640,49280,43780,6,3080,6168
       DATA 3075,3,775,3614,12995,0,259,3608
       DATA 28864,134,769,43783,128,49200,7936,171
       DATA 1028,1671,64512,8224,24640,49280,65451,1536
       DATA 4088,43780,64,49280,43782,48,12350,25368
       DATA 4112,8288,16512,32939,1536,263,43781,8288
       DATA 49152,7,3080,6160,12320,224,1797,939
       DATA 1792,65408,49216,43780,511,14368,24705,259
       DATA 646,33988,19627,1024,43780,354,49794,33451
       DATA 770,1707,43008,17222,31792,43780,240,8107
       DATA 1536,7408,43790,32,12312,3587,43781,1
       DATA 16352,43779,64,16576,43781,64,49281,65451
       DATA 1024,30736,64519,1,256,285,14833,33025
       DATA 65024,1028,3128,57568,14351,43783,248,43776
       DATA 171,0,43861,3,1028,43781,247,514
       DATA 43781,244,5701,43781,55,4369,43781,194
       DATA 1288,43781,28,2184,43789,31,8224,43781
       DATA 62,37152,43781,32,12714,43781,191,37008
       DATA 43781,49,41120,43781,191,42116,43781,191
       DATA 36882,43781,191,36880,43781,49,41124,43781
       DATA 132,35473,43781,63,4112,43781,63,37010
       DATA 43781,128,32939,24832,43779,1027,43780,243
       DATA 37394,63403,1024,50244,5366,43780,145,20785
       DATA 6059,1024,4127,4312,43780,72,51272,53163
       DATA 1536,16576,43780,171,800,8107,1024,8224
       DATA 37134,43780,164,42016,12715,1024,40848,37048
       DATA 43780,171,800,8107,1024,43779,33806,43780
       DATA 30,4624,16299,1024,7954,37305,43780,36
       DATA 10801,41131,1024,41151,41137,43780,159,37521
       DATA 47531,1024,7698,4287,43782,128,32939,33792
       DATA 32289,8510,8224,28843,1536,6168,124,8875
       DATA 833,8732,43782,24,6315,2304,64578,17020
       DATA 16962,64512,63556,43779,33348,14336,50818,17464
       DATA 17538,50859,1792,256,17348,17475,17476,62208
       DATA 58132,4320,4116,58112,57360,4320,4112,57515
       DATA 35584,427,1282,0,64257,377,18697,0
       DATA 61448,2546,8978,0,17313,4361,63753,0
       DATA 64266,8416,8363,768,64329,43779,16961,0
       DATA 57875,43779,2578,0,6152,34888,10264,43782
       DATA 192,49152,4,1541,43779,1024,16,12626
       DATA 38039,5120,128,16416,4336,4096,3,1032
       DATA 2314,1024,162,18082,8738,16896,63,8239
       DATA 12288,8192,8,6152,43779,34816,56,17542
       DATA 35442,1195,30720,427,1792,64427,1792,39851
       DATA 1792,7083,1792,32939,1792,57515,1792,58283
       DATA 1792,2219,1792,16512,43782,6,43783,54
       DATA 43783,48,43783,11,43783,143,43783,159
       DATA 43783,62,43783,56,43847,171,43947,0
*
*
       END
